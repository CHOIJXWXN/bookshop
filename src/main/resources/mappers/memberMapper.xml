<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bookshop.mappers.member">

<!-- (마이페이지) 회원정보 불러오기 -->

<select id="getUserInfo" resultType="Users">
	SELECT *
	FROM USERS
	WHERE user_id = #{user_id}
</select>

<!-- (마이페이지) 회원정보 수정하기 -->
<update id="profile">
	UPDATE USERS
	SET user_pw = #{user_pw}, user_name = #{user_name}, user_birth = #{user_birth}, user_nickname = #{user_nickname}, user_phone = #{user_phone}, user_addr = #{user_addr}
	WHERE user_id = #{user_id}
</update>

<!-- (마이페이지) 주문/배송 조회 리스트 불러오기 -->
<!-- Orders 가져오기 order_num pk -->
<select id="getOrders" resultType="Orders">
	SELECT order_num, order_date, order_status
	FROM ORDERS
	WHERE user_id = #{user_id}
	ORDER BY order_num DESC
	LIMIT 2
</select>

<!-- ORDERLIST 가져오기 order_num & book_id pk -->
<select id="getOrderList" resultType="OrderList">
	SELECT book_id, book_cnt
	FROM ORDERLIST
	WHERE order_num = #{order_num};
</select>

<!-- Book 정보 가져오기 book_id pk -->
<select id="getBook" resultType="Book">
	SELECT book_cover, book_title, book_writer, book_price
	FROM book
	WHERE book_id = #{book_id};
</select>

<!-- (마이페이지) 보유 포인트 가져오기 -->
<select id="getPoint" resultType="_int">
	SELECT user_point
	FROM USERS
	WHERE user_id = #{user_id};
</select>

<!-- (마이페이지) 주문목록 건수 가져오기 -->
<select id="getOrderCnt" resultType="_int">
	SELECT COUNT(order_num)
	FROM ORDERS
	WHERE user_id = #{user_id};
</select>

<!-- (마이페이지) 최신 주문번호 가져오기 -->
<select id="getRecentOrderNum" resultType="String">
	SELECT *
	FROM ORDERS
	WHERE user_id = #{user_id}
	ORDER BY order_num DESC;
</select>

</mapper>